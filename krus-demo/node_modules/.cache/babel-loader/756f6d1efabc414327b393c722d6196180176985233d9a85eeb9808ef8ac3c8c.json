{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\admin\\\\Desktop\\\\merged\\\\krus-demo\\\\src\\\\App.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useRef } from \"react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport './App.css';\nimport logo from './assets/logo2.png';\nimport sendIcon from './assets/send.png';\n// import chatBubble2 from './assets/chat-bubble.png';\nimport chatBubble2 from './assets/new-message-5.png';\n\n// === Backend API helpers ===\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API_BASE = (process.env.REACT_APP_API_BASE || \"http://localhost:8000\").replace(/\\/$/, \"\");\nasync function apiAsk(question, reset_memory = false) {\n  const r = await fetch(`${API_BASE}/ask`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify({\n      question,\n      reset_memory\n    })\n  });\n  if (!r.ok) throw new Error(\"ask failed\");\n  return await r.json(); // { answer, citations }\n}\nasync function apiFollowUp() {\n  const r = await fetch(`${API_BASE}/followup`, {\n    method: \"POST\"\n  });\n  if (!r.ok) throw new Error(\"followup failed\");\n  return await r.json();\n}\nasync function apiReset() {\n  const r = await fetch(`${API_BASE}/reset`, {\n    method: \"POST\"\n  });\n  if (!r.ok) throw new Error(\"reset failed\");\n  return await r.json();\n}\n// === end API helpers ===\n\nexport default function DomainChatPoC() {\n  _s();\n  const [conversations, setConversations] = useState(() => {\n    try {\n      const raw = localStorage.getItem(\"poc_domain_chat_history\");\n      return raw ? JSON.parse(raw) : [{\n        id: genId(),\n        name: \"GÅ‚Ã³wna rozmowa\",\n        messages: []\n      }];\n    } catch (e) {\n      return [{\n        id: genId(),\n        name: \"GÅ‚Ã³wna rozmowa\",\n        messages: []\n      }];\n    }\n  });\n  const [activeConvIdx, setActiveConvIdx] = useState(0);\n  const [input, setInput] = useState(\"\");\n  const [isTyping, setIsTyping] = useState(false);\n  const [canFollowUp, setCanFollowUp] = useState(false);\n  const [followUpArmed, setFollowUpArmed] = useState(false);\n  const [questionCount, setQuestionCount] = useState(0);\n  const endRef = useRef(null);\n  const textareaRef = useRef(null);\n  const MAX_LINES = 6;\n  useEffect(() => {\n    localStorage.setItem(\"poc_domain_chat_history\", JSON.stringify(conversations));\n  }, [conversations]);\n  useEffect(() => scrollToBottom(), [conversations, activeConvIdx]);\n  useEffect(() => {\n    const ta = textareaRef.current;\n    if (!ta) return;\n\n    // ustawienia box-sizing i reset wysokoÅ›ci\n    ta.style.boxSizing = \"border-box\";\n    ta.style.height = \"auto\";\n    const computed = window.getComputedStyle(ta);\n\n    // pobierz lineHeight (jeÅ›li 'normal' -> fallback do 1.2 * fontSize)\n    let lineHeight = parseFloat(computed.lineHeight);\n    if (Number.isNaN(lineHeight)) {\n      const fontSize = parseFloat(computed.fontSize) || 16;\n      lineHeight = fontSize * 1.2;\n    }\n\n    // paddingy i obramowania (Å¼eby dokÅ‚adnie policzyÄ‡ wysokoÅ›Ä‡)\n    const paddingTop = parseFloat(computed.paddingTop) || 0;\n    const paddingBottom = parseFloat(computed.paddingBottom) || 0;\n    const borderTop = parseFloat(computed.borderTopWidth) || 0;\n    const borderBottom = parseFloat(computed.borderBottomWidth) || 0;\n    const maxHeightPx = Math.round(lineHeight * MAX_LINES + paddingTop + paddingBottom + borderTop + borderBottom);\n\n    // desired = minimalna z naturalnej zawartoÅ›ci i maxHeight\n    const desired = Math.min(ta.scrollHeight, maxHeightPx);\n    ta.style.height = desired + \"px\";\n\n    // jeÅ›li zawartoÅ›Ä‡ przekracza max -> wÅ‚Ä…cz scroll w textarea, inaczej ukryj\n    ta.style.overflowY = ta.scrollHeight > maxHeightPx ? \"auto\" : \"hidden\";\n  }, [input]);\n  function genId() {\n    return Math.random().toString(36).slice(2, 9);\n  }\n  const handleSendEnter = e => {\n    if (e.nativeEvent && e.nativeEvent.isComposing) return;\n    if (e.key === \"Enter\" && !e.shiftKey) {\n      handleSend(e);\n    }\n  };\n  function addMessage(role, text, extra = undefined) {\n    setConversations(prev => {\n      const copy = [...prev];\n      copy[activeConvIdx] = {\n        ...copy[activeConvIdx]\n      };\n      copy[activeConvIdx].messages = [...copy[activeConvIdx].messages, {\n        id: genId(),\n        role,\n        text,\n        ts: Date.now(),\n        ...extra\n      }];\n      return copy;\n    });\n  }\n  function handleSend(e) {\n    e === null || e === void 0 ? void 0 : e.preventDefault();\n    const question = input.trim();\n    if (!question) return;\n    addMessage(\"user\", question);\n    setInput(\"\");\n    simulateAssistantAnswer(question);\n  }\n  async function simulateAssistantAnswer(question) {\n    try {\n      var _res$answer;\n      setIsTyping(true);\n      const res = await apiAsk(question, false);\n      const answer = (_res$answer = res === null || res === void 0 ? void 0 : res.answer) !== null && _res$answer !== void 0 ? _res$answer : \"Brak odpowiedzi.\";\n      const rows = Array.isArray(res === null || res === void 0 ? void 0 : res.data_rows) ? res.data_rows : [];\n      const cols = Array.isArray(res === null || res === void 0 ? void 0 : res.data_columns) ? res.data_columns : [];\n\n      // 1) tekst (animowane â€žpisanieâ€)\n      typeAssistantText(answer);\n\n      // 2) jeÅ›li sÄ… wiersze tabeli â€” doÅ‚Ã³Å¼ je jako osobny â€žblokâ€\n      if (rows.length) {\n        // po zakoÅ„czeniu â€žpisaniaâ€ teÅ¼ jest OK, ale najproÅ›ciej od razu:\n        addMessage(\"assistant\", \"[[TABLE]]\", {\n          table: {\n            cols,\n            rows\n          }\n        });\n      }\n      setQuestionCount(n => n + 1);\n      setCanFollowUp((res === null || res === void 0 ? void 0 : res.module) === \"ustawa\");\n      setFollowUpArmed(false);\n    } catch (e) {\n      console.error(e);\n      typeAssistantText(\"BÅ‚Ä…d poÅ‚Ä…czenia z backendem.\");\n    }\n  }\n  function typeAssistantText(fullText) {\n    let i = 0;\n    addMessage(\"assistant\", \"\");\n    const interval = setInterval(() => {\n      i += Math.ceil(Math.random() * 3);\n      const slice = fullText.slice(0, i);\n      setConversations(prev => {\n        const copy = [...prev];\n        const msgs = [...copy[activeConvIdx].messages];\n        const lastIdx = msgs.length - 1;\n        if (msgs[lastIdx].role === \"assistant\") {\n          msgs[lastIdx] = {\n            ...msgs[lastIdx],\n            text: slice\n          };\n        }\n        copy[activeConvIdx] = {\n          ...copy[activeConvIdx],\n          messages: msgs\n        };\n        return copy;\n      });\n      if (i >= fullText.length) {\n        clearInterval(interval);\n        setIsTyping(false);\n      }\n    }, 35);\n  }\n  async function armFollowUp() {\n    try {\n      await apiFollowUp();\n      setFollowUpArmed(true);\n    } catch (e) {\n      console.error(e);\n    }\n  }\n  function newConversation() {\n    setConversations(prev => [...prev, {\n      id: genId(),\n      name: \"Rozmowa \" + (prev.length + 1),\n      messages: []\n    }]);\n    setActiveConvIdx(conversations.length);\n    apiReset().catch(e => console.warn(\"apiReset failed\", e));\n  }\n  function clearActiveConversation() {\n    setConversations(prev => {\n      const copy = [...prev];\n      copy[activeConvIdx] = {\n        ...copy[activeConvIdx],\n        messages: []\n      };\n      return copy;\n    });\n    apiReset().catch(e => console.warn(\"apiReset failed\", e));\n  }\n  function scrollToBottom() {\n    var _endRef$current;\n    (_endRef$current = endRef.current) === null || _endRef$current === void 0 ? void 0 : _endRef$current.scrollIntoView({\n      behavior: \"smooth\",\n      block: \"end\"\n    });\n  }\n  const activeConv = conversations[activeConvIdx] || {\n    messages: []\n  };\n  const msgs = activeConv.messages || [];\n  const lastAssistantIdx = (() => {\n    for (let i = msgs.length - 1; i >= 0; i--) {\n      if (msgs[i].role === \"assistant\") return i;\n    }\n    return -1;\n  })();\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"relative h-screen font-sans\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"absolute inset-0 bg-cover bg-center absolute-background\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"absolute inset-0\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 224,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"relative grid grid-cols-12 h-full\",\n      children: [/*#__PURE__*/_jsxDEV(\"aside\", {\n        className: \"col-span-3 border-slate-200 p-4 shadow-lg flex flex-col bg-white/80 overflow-y-auto\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center justify-between mb-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            className: \"text-lg font-semibold text-slate-800\",\n            children: [/*#__PURE__*/_jsxDEV(\"img\", {\n              width: 28,\n              height: 28,\n              src: logo,\n              alt: \"logo\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 232,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \" KRUS AI\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 233,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 231,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"new-message text-sm px-3 py-1 bg-brand hover:bg-brand-dark transition text-white rounded-lg shadow\",\n            onClick: newConversation,\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              src: chatBubble2,\n              width: 22,\n              height: 22\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 239,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 235,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 230,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-2 overflow-auto flex-1 pr-1 chat-lists\",\n          children: conversations.map((c, idx) => /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setActiveConvIdx(idx),\n            className: `w-full text-left p-3 rounded-lg flex items-center justify-between transition ${idx === activeConvIdx ? \"bg-brand-light border-l-4 border-brand-dark\" : \"hover:bg-slate-50\"}`,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"font-medium text-sm text-slate-800\",\n                children: c.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 255,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-xs text-slate-500\",\n                children: [c.messages.length, \" wiadomo\\u015Bci\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 256,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 254,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-xs text-slate-400\",\n              children: c.messages.length ? formatAgo(c.messages[c.messages.length - 1].ts) : \"â€”\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 258,\n              columnNumber: 33\n            }, this)]\n          }, c.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 245,\n            columnNumber: 29\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 243,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mt-6 text-xs text-slate-500\",\n          children: \"Asystent udziela informacji w zakresie ustawy o ubezpieczeniu spo\\u0142ecznym rolnik\\xF3w. Odpowiedzi nie stanowi\\u0105 porady prawnej.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 265,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 17\n      }, this), activeConv.messages.length > 0 ? /*#__PURE__*/_jsxDEV(\"main\", {\n        className: \"flex-1 overflow-y-auto col-span-9 flex flex-col\",\n        children: [/*#__PURE__*/_jsxDEV(\"header\", {\n          className: \"px-6 py-4 border-slate-200   flex items-center justify-between bg-white/40\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"text-lg font-semibold text-slate-800\",\n              children: activeConv.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 275,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 274,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 273,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n          className: \"flex-1 p-6 overflow-y-auto  from-white to-slate-50 chat-messages bg-white/40\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"max-w-3xl mx-auto space-y-4\",\n            children: [/*#__PURE__*/_jsxDEV(AnimatePresence, {\n              initial: false,\n              children: activeConv.messages.map((msg, idx) => /*#__PURE__*/_jsxDEV(motion.div, {\n                initial: {\n                  opacity: 0,\n                  y: 6\n                },\n                animate: {\n                  opacity: 1,\n                  y: 0\n                },\n                exit: {\n                  opacity: 0,\n                  y: -6\n                },\n                children: /*#__PURE__*/_jsxDEV(MessageBubble, {\n                  msg: msg,\n                  isLastAssistant: idx === lastAssistantIdx,\n                  showFollowUp: canFollowUp && questionCount >= 1 && !followUpArmed,\n                  onFollowUp: armFollowUp\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 289,\n                  columnNumber: 41\n                }, this)\n              }, msg.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 283,\n                columnNumber: 37\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 281,\n              columnNumber: 33\n            }, this), isTyping && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-start animate-pulse\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"w-9 h-9 rounded-full bg-green-100 flex items-center justify-center text-xs text-brand-dark font-bold\",\n                children: \"A\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 301,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"ml-3 px-4 py-2 bg-slate-100 rounded-xl text-sm shadow-sm italic text-gray-500\",\n                children: \"Pisze...\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 304,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 300,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              ref: endRef\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 307,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 280,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 279,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: handleSend,\n          className: \"px-6 py-4  border-slate-200  shadow-inner shrink-0 bg-white/40\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"max-w-3xl mx-auto flex gap-3 \",\n            children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n              ref: textareaRef,\n              value: input,\n              rows: 1,\n              onKeyDown: handleSendEnter,\n              onChange: e => setInput(e.target.value),\n              className: \"input-text border-green resize-none  flex-1 p-3 rounded-xl border border-slate-200 focus:outline-none focus:ring-1 focus:ring-brand shadow-sm\",\n              placeholder: \"Zadaj pytanie...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 316,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"submit\",\n              className: \"px-5 py-2 rounded-xl bg-brand hover:bg-brand-dark transition text-white font-medium shadow-md disabled:opacity-50\",\n              disabled: !input.trim(),\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                height: 20,\n                width: 20,\n                src: sendIcon,\n                alt: \"send\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 330,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 325,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 315,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 311,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 272,\n        columnNumber: 21\n      }, this) : /*#__PURE__*/_jsxDEV(\"main\", {\n        className: \"flex-1 overflow-y-auto col-span-9 flex flex-col\",\n        children: /*#__PURE__*/_jsxDEV(motion.section, {\n          className: \"flex-1 flex flex-col items-center welcome-stext justify-center text-center px-6 bg-white/40\",\n          initial: {\n            opacity: 0\n          },\n          animate: {\n            opacity: 1\n          },\n          exit: {\n            opacity: 0\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n            className: \"main-text text-2xl font-bold  mb-4\",\n            children: \"\\uD83D\\uDC4B Witaj! Tu Asystent Kasy Rolniczego Ubezpieczenia Spo\\u0142ecznego\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 344,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"main-text text-semibold mb-8 max-w-screen-lg\",\n            children: [\"Udzielam informacji w zakresie ustawy o ubezpieczeniu spo\\u0142ecznym rolnik\\xF3w, w tym kogo obejmuje ubezpieczenie i jakie \\u015Bwiadczenia przys\\u0142uguj\\u0105. Mog\\u0119 tak\\u017Ce odpowiada\\u0107 na pytania dotycz\\u0105ce danych statystycznych, takich jak kwoty i liczba \\u015Bwiadcze\\u0144 w latach 2024\\u20132025.\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 348,\n              columnNumber: 296\n            }, this), \"Udzielane informacje maj\\u0105 charakter og\\xF3lny i nie stanowi\\u0105 porady prawnej ani indywidualnej interpretacji przepis\\xF3w.                            \"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 347,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-full max-w-2xl\",\n            children: /*#__PURE__*/_jsxDEV(\"form\", {\n              onSubmit: handleSend,\n              className: \"flex gap-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n                ref: textareaRef,\n                value: input,\n                rows: 1,\n                onKeyDown: handleSendEnter,\n                onChange: e => setInput(e.target.value),\n                className: \"input-text resize-none flex-1 p-3 rounded-xl border border-slate-200 focus:outline-none focus:ring-1 focus:ring-brand shadow-sm\",\n                placeholder: \"Zadaj pytanie...\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 352,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"submit\",\n                className: \"px-5 py-2 rounded-xl bg-brand hover:bg-brand-dark transition text-white font-medium shadow-md disabled:opacity-50\",\n                disabled: !input.trim(),\n                children: /*#__PURE__*/_jsxDEV(\"img\", {\n                  height: 20,\n                  width: 20,\n                  src: sendIcon,\n                  alt: \"send\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 366,\n                  columnNumber: 41\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 361,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 351,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 350,\n            columnNumber: 29\n          }, this)]\n        }, \"welcome\", true, {\n          fileName: _jsxFileName,\n          lineNumber: 337,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 336,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 218,\n    columnNumber: 9\n  }, this);\n}\n_s(DomainChatPoC, \"JavN8DFSwBxMBQy9+yv73a3Sha4=\");\n_c = DomainChatPoC;\nfunction MessageBubble({\n  msg,\n  isLastAssistant = false,\n  showFollowUp = false,\n  onFollowUp\n}) {\n  var _msg$text, _msg$table$cols, _msg$table$rows$;\n  if (msg.role === \"user\") {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-start justify-end\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"max-w-[70%]\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-xs text-slate-400 text-right mb-1\",\n          children: \"Ty\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 384,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-brand text-white px-4 py-2 rounded-xl text-sm shadow-md break-words whitespace-pre-wrap\",\n          children: msg.text\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 385,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 383,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 382,\n      columnNumber: 7\n    }, this);\n  }\n  const safeText = ((_msg$text = msg.text) !== null && _msg$text !== void 0 ? _msg$text : \"\").replace(/\\\\n/g, \"\\n\");\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex items-start\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-9 h-9 rounded-full bg-brand-light flex items-center justify-center text-xs ai-text font-bold\",\n      children: \"A\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 397,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ml-3 max-w-[70%]\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-xs text-slate-400 mb-1\",\n        children: \"Asystent\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 399,\n        columnNumber: 9\n      }, this), safeText && safeText !== \"[[TABLE]]\" && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white px-4 py-2 rounded-xl border border-slate-200 text-sm shadow-sm break-words whitespace-pre-wrap\",\n        children: safeText\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 403,\n        columnNumber: 11\n      }, this), msg.table && Array.isArray(msg.table.rows) && msg.table.rows.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-2 bg-white rounded-xl border border-slate-200 shadow-sm overflow-x-auto\",\n        children: /*#__PURE__*/_jsxDEV(\"table\", {\n          className: \"min-w-full text-sm\",\n          children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n            className: \"bg-slate-50\",\n            children: /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: ((_msg$table$cols = msg.table.cols) !== null && _msg$table$cols !== void 0 ? _msg$table$cols : Object.keys((_msg$table$rows$ = msg.table.rows[0]) !== null && _msg$table$rows$ !== void 0 ? _msg$table$rows$ : {})).map(c => /*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"px-3 py-2 text-left font-semibold text-slate-700 border-b\",\n                children: headerLabel(c)\n              }, c, false, {\n                fileName: _jsxFileName,\n                lineNumber: 415,\n                columnNumber: 21\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 413,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 412,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n            children: msg.table.rows.map((r, idx) => {\n              var _msg$table$cols2;\n              return /*#__PURE__*/_jsxDEV(\"tr\", {\n                className: \"even:bg-slate-50/40\",\n                children: ((_msg$table$cols2 = msg.table.cols) !== null && _msg$table$cols2 !== void 0 ? _msg$table$cols2 : Object.keys(r)).map(c => /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"px-3 py-2 text-slate-800 border-b align-top\",\n                  children: formatCell(r[c], c)\n                }, c, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 425,\n                  columnNumber: 23\n                }, this))\n              }, idx, false, {\n                fileName: _jsxFileName,\n                lineNumber: 423,\n                columnNumber: 19\n              }, this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 421,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 411,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 410,\n        columnNumber: 11\n      }, this), isLastAssistant && showFollowUp && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-3\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: onFollowUp,\n          className: \"mx-auto block px-5 py-2 rounded-xl bg-brand hover:bg-brand-dark transition text-white font-medium shadow-md focus:outline-none focus:ring-2 focus:ring-brand/40\",\n          title: \"Nast\\u0119pne pytanie potraktuj\\u0119 jako dopytanie.\",\n          children: \"Chcia\\u0142bym dopyta\\u0107\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 439,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 438,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 398,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 396,\n    columnNumber: 5\n  }, this);\n}\n\n// Å‚adniejsze nagÅ‚Ã³wki\n_c2 = MessageBubble;\nfunction headerLabel(key) {\n  var _map$key;\n  const map = {\n    value: \"wartoÅ›Ä‡\",\n    dataset: \"tabela\",\n    measure: \"miara\",\n    type: \"typ\",\n    okres: \"okres\",\n    region: \"region\",\n    ce: \"ce\",\n    rrf: \"rrf\"\n  };\n  return (_map$key = map[key]) !== null && _map$key !== void 0 ? _map$key : key;\n}\n\n// delikatne formatowanie wartoÅ›ci\nfunction formatCell(v, key) {\n  if (v == null) return \"â€”\";\n  if ((key === \"value\" || key === \"ce\" || key === \"rrf\") && typeof v === \"number\") {\n    // value: do 2 miejsc; ce/rrf: do 3\n    const digits = key === \"value\" ? 2 : 3;\n    return v.toLocaleString(\"pl-PL\", {\n      maximumFractionDigits: digits\n    });\n  }\n  return String(v);\n}\nfunction formatAgo(ts) {\n  if (!ts) return \"â€”\";\n  const diff = Math.floor((Date.now() - ts) / 1000);\n  if (diff < 60) return `${diff}s`;\n  if (diff < 3600) return `${Math.floor(diff / 60)}m`;\n  if (diff < 86400) return `${Math.floor(diff / 3600)}h`;\n  return `${Math.floor(diff / 86400)}d`;\n}\nvar _c, _c2;\n$RefreshReg$(_c, \"DomainChatPoC\");\n$RefreshReg$(_c2, \"MessageBubble\");","map":{"version":3,"names":["React","useEffect","useState","useRef","motion","AnimatePresence","logo","sendIcon","chatBubble2","jsxDEV","_jsxDEV","API_BASE","process","env","REACT_APP_API_BASE","replace","apiAsk","question","reset_memory","r","fetch","method","headers","body","JSON","stringify","ok","Error","json","apiFollowUp","apiReset","DomainChatPoC","_s","conversations","setConversations","raw","localStorage","getItem","parse","id","genId","name","messages","e","activeConvIdx","setActiveConvIdx","input","setInput","isTyping","setIsTyping","canFollowUp","setCanFollowUp","followUpArmed","setFollowUpArmed","questionCount","setQuestionCount","endRef","textareaRef","MAX_LINES","setItem","scrollToBottom","ta","current","style","boxSizing","height","computed","window","getComputedStyle","lineHeight","parseFloat","Number","isNaN","fontSize","paddingTop","paddingBottom","borderTop","borderTopWidth","borderBottom","borderBottomWidth","maxHeightPx","Math","round","desired","min","scrollHeight","overflowY","random","toString","slice","handleSendEnter","nativeEvent","isComposing","key","shiftKey","handleSend","addMessage","role","text","extra","undefined","prev","copy","ts","Date","now","preventDefault","trim","simulateAssistantAnswer","_res$answer","res","answer","rows","Array","isArray","data_rows","cols","data_columns","typeAssistantText","length","table","n","module","console","error","fullText","i","interval","setInterval","ceil","msgs","lastIdx","clearInterval","armFollowUp","newConversation","catch","warn","clearActiveConversation","_endRef$current","scrollIntoView","behavior","block","activeConv","lastAssistantIdx","className","children","fileName","_jsxFileName","lineNumber","columnNumber","width","src","alt","onClick","map","c","idx","formatAgo","initial","msg","div","opacity","y","animate","exit","MessageBubble","isLastAssistant","showFollowUp","onFollowUp","ref","onSubmit","value","onKeyDown","onChange","target","placeholder","type","disabled","section","_c","_msg$text","_msg$table$cols","_msg$table$rows$","safeText","Object","keys","headerLabel","_msg$table$cols2","formatCell","title","_c2","_map$key","dataset","measure","okres","region","ce","rrf","v","digits","toLocaleString","maximumFractionDigits","String","diff","floor","$RefreshReg$"],"sources":["C:/Users/admin/Desktop/merged/krus-demo/src/App.js"],"sourcesContent":["import React, { useEffect, useState, useRef } from \"react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport './App.css';\nimport logo from './assets/logo2.png';\nimport sendIcon from './assets/send.png';\n// import chatBubble2 from './assets/chat-bubble.png';\nimport chatBubble2 from './assets/new-message-5.png';\n\n\n// === Backend API helpers ===\nconst API_BASE = (process.env.REACT_APP_API_BASE || \"http://localhost:8000\").replace(/\\/$/, \"\");\n\nasync function apiAsk(question, reset_memory = false) {\n  const r = await fetch(`${API_BASE}/ask`, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify({ question, reset_memory })\n  });\n  if (!r.ok) throw new Error(\"ask failed\");\n  return await r.json(); // { answer, citations }\n}\n\nasync function apiFollowUp() {\n  const r = await fetch(`${API_BASE}/followup`, { method: \"POST\" });\n  if (!r.ok) throw new Error(\"followup failed\");\n  return await r.json();\n}\n\nasync function apiReset() {\n  const r = await fetch(`${API_BASE}/reset`, { method: \"POST\" });\n  if (!r.ok) throw new Error(\"reset failed\");\n  return await r.json();\n}\n// === end API helpers ===\n\n\nexport default function DomainChatPoC() {\n    const [conversations, setConversations] = useState(() => {\n        try {\n            const raw = localStorage.getItem(\"poc_domain_chat_history\");\n            return raw ? JSON.parse(raw) : [{ id: genId(), name: \"GÅ‚Ã³wna rozmowa\", messages: [] }];\n        } catch (e) {\n            return [{ id: genId(), name: \"GÅ‚Ã³wna rozmowa\", messages: [] }];\n        }\n    });\n    const [activeConvIdx, setActiveConvIdx] = useState(0);\n    const [input, setInput] = useState(\"\");\n    const [isTyping, setIsTyping] = useState(false);\n    \n    const [canFollowUp, setCanFollowUp] = useState(false);\n    const [followUpArmed, setFollowUpArmed] = useState(false);\n    const [questionCount, setQuestionCount] = useState(0);\nconst endRef = useRef(null);\n    const textareaRef = useRef(null);\n    const MAX_LINES = 6;\n\n\n    useEffect(() => {\n        localStorage.setItem(\"poc_domain_chat_history\", JSON.stringify(conversations));\n    }, [conversations]);\n\n    useEffect(() => scrollToBottom(), [conversations, activeConvIdx]);\n\n    useEffect(() => {\n        const ta = textareaRef.current;\n        if (!ta) return;\n\n        // ustawienia box-sizing i reset wysokoÅ›ci\n        ta.style.boxSizing = \"border-box\";\n        ta.style.height = \"auto\";\n\n        const computed = window.getComputedStyle(ta);\n\n        // pobierz lineHeight (jeÅ›li 'normal' -> fallback do 1.2 * fontSize)\n        let lineHeight = parseFloat(computed.lineHeight);\n        if (Number.isNaN(lineHeight)) {\n            const fontSize = parseFloat(computed.fontSize) || 16;\n            lineHeight = fontSize * 1.2;\n        }\n\n        // paddingy i obramowania (Å¼eby dokÅ‚adnie policzyÄ‡ wysokoÅ›Ä‡)\n        const paddingTop = parseFloat(computed.paddingTop) || 0;\n        const paddingBottom = parseFloat(computed.paddingBottom) || 0;\n        const borderTop = parseFloat(computed.borderTopWidth) || 0;\n        const borderBottom = parseFloat(computed.borderBottomWidth) || 0;\n\n        const maxHeightPx =\n            Math.round(lineHeight * MAX_LINES + paddingTop + paddingBottom + borderTop + borderBottom);\n\n        // desired = minimalna z naturalnej zawartoÅ›ci i maxHeight\n        const desired = Math.min(ta.scrollHeight, maxHeightPx);\n\n        ta.style.height = desired + \"px\";\n\n        // jeÅ›li zawartoÅ›Ä‡ przekracza max -> wÅ‚Ä…cz scroll w textarea, inaczej ukryj\n        ta.style.overflowY = ta.scrollHeight > maxHeightPx ? \"auto\" : \"hidden\";\n    }, [input]);\n\n    function genId() {\n        return Math.random().toString(36).slice(2, 9);\n    }\n\n    const handleSendEnter = (e) => {\n        if (e.nativeEvent && e.nativeEvent.isComposing) return;\n\n        if (e.key === \"Enter\" && !e.shiftKey) {\n            handleSend(e);\n        }\n    };\n    function addMessage(role, text, extra = undefined) {\n    setConversations(prev => {\n        const copy = [...prev];\n        copy[activeConvIdx] = { ...copy[activeConvIdx] };\n        copy[activeConvIdx].messages = [\n        ...copy[activeConvIdx].messages,\n        { id: genId(), role, text, ts: Date.now(), ...extra },\n        ];\n        return copy;\n    });\n    }\n\n    function handleSend(e) {\n        e?.preventDefault();\n        const question = input.trim();\n        if (!question) return;\n        addMessage(\"user\", question);\n        setInput(\"\");\n        simulateAssistantAnswer(question);\n    }\n\n    async function simulateAssistantAnswer(question) {\n    try {\n        setIsTyping(true);\n        const res = await apiAsk(question, false);\n\n        const answer = res?.answer ?? \"Brak odpowiedzi.\";\n        const rows = Array.isArray(res?.data_rows) ? res.data_rows : [];\n        const cols = Array.isArray(res?.data_columns) ? res.data_columns : [];\n\n        // 1) tekst (animowane â€žpisanieâ€)\n        typeAssistantText(answer);\n\n        // 2) jeÅ›li sÄ… wiersze tabeli â€” doÅ‚Ã³Å¼ je jako osobny â€žblokâ€\n        if (rows.length) {\n        // po zakoÅ„czeniu â€žpisaniaâ€ teÅ¼ jest OK, ale najproÅ›ciej od razu:\n        addMessage(\"assistant\", \"[[TABLE]]\", { table: { cols, rows } });\n        }\n\n        setQuestionCount(n => n + 1);\n        setCanFollowUp(res?.module === \"ustawa\");\n        setFollowUpArmed(false);\n    } catch (e) {\n        console.error(e);\n        typeAssistantText(\"BÅ‚Ä…d poÅ‚Ä…czenia z backendem.\");\n    }\n    }\n    function typeAssistantText(fullText) {\n        let i = 0;\n        addMessage(\"assistant\", \"\");\n        const interval = setInterval(() => {\n            i += Math.ceil(Math.random() * 3);\n            const slice = fullText.slice(0, i);\n            setConversations(prev => {\n                const copy = [...prev];\n                const msgs = [...copy[activeConvIdx].messages];\n                const lastIdx = msgs.length - 1;\n                if (msgs[lastIdx].role === \"assistant\") {\n                    msgs[lastIdx] = { ...msgs[lastIdx], text: slice };\n                }\n                copy[activeConvIdx] = { ...copy[activeConvIdx], messages: msgs };\n                return copy;\n            });\n            if (i >= fullText.length) {\n                clearInterval(interval);\n                setIsTyping(false);\n            }\n        }, 35);\n    }\n\n    async function armFollowUp() {\n        try {\n            await apiFollowUp();\n            setFollowUpArmed(true);\n        } catch (e) {\n            console.error(e);\n        }\n    }\n\n    function newConversation() {\n        setConversations(prev => [...prev, { id: genId(), name: \"Rozmowa \" + (prev.length + 1), messages: [] }]);\n        setActiveConvIdx(conversations.length);\n        apiReset().catch(e => console.warn(\"apiReset failed\", e));\n    }\n\n    function clearActiveConversation() {\n        setConversations(prev => {\n            const copy = [...prev];\n            copy[activeConvIdx] = { ...copy[activeConvIdx], messages: [] };\n            return copy;\n        });\n        apiReset().catch(e => console.warn(\"apiReset failed\", e));\n    }\n\n    function scrollToBottom() {\n        endRef.current?.scrollIntoView({ behavior: \"smooth\", block: \"end\" });\n    }\n\n    const activeConv = conversations[activeConvIdx] || { messages: [] };\n    const msgs = activeConv.messages || [];\n    const lastAssistantIdx = (() => {\n    for (let i = msgs.length - 1; i >= 0; i--) {\n        if (msgs[i].role === \"assistant\") return i;\n    }\n    return -1;\n    })();\n\n    return (\n        <div className=\"relative h-screen font-sans\">\n            {/* TÅ‚o z pola */}\n            <div\n                className=\"absolute inset-0 bg-cover bg-center absolute-background\"\n            />\n            {/* NakÅ‚adka pÃ³Å‚przezroczysta */}\n            <div className=\"absolute inset-0\" />\n\n            {/* WÅ‚aÅ›ciwa zawartoÅ›Ä‡ czatu */}\n            <div className=\"relative grid grid-cols-12 h-full\">\n                {/* Sidebar */}\n                <aside className=\"col-span-3 border-slate-200 p-4 shadow-lg flex flex-col bg-white/80 overflow-y-auto\">\n                    <div className=\"flex items-center justify-between mb-6\">\n                        <h2 className=\"text-lg font-semibold text-slate-800\">\n                            <img width={28} height={28} src={logo} alt=\"logo\" />\n                            <span> KRUS AI</span>\n                        </h2>\n                        <button\n                            className=\"new-message text-sm px-3 py-1 bg-brand hover:bg-brand-dark transition text-white rounded-lg shadow\"\n                            onClick={newConversation}\n                        >\n                            <img src={chatBubble2} width={22} height={22} />\n                        </button>\n                    </div>\n\n                    <div className=\"space-y-2 overflow-auto flex-1 pr-1 chat-lists\">\n                        {conversations.map((c, idx) => (\n                            <button\n                                key={c.id}\n                                onClick={() => setActiveConvIdx(idx)}\n                                className={`w-full text-left p-3 rounded-lg flex items-center justify-between transition ${\n                                    idx === activeConvIdx\n                                        ? \"bg-brand-light border-l-4 border-brand-dark\"\n                                        : \"hover:bg-slate-50\"\n                                }`}\n                            >\n                                <div>\n                                    <div className=\"font-medium text-sm text-slate-800\">{c.name}</div>\n                                    <div className=\"text-xs text-slate-500\">{c.messages.length} wiadomoÅ›ci</div>\n                                </div>\n                                <div className=\"text-xs text-slate-400\">\n                                    {c.messages.length ? formatAgo(c.messages[c.messages.length - 1].ts) : \"â€”\"}\n                                </div>\n                            </button>\n                        ))}\n                    </div>\n\n                    <div className=\"mt-6 text-xs text-slate-500\">\n                        Asystent udziela informacji w zakresie ustawy o ubezpieczeniu spoÅ‚ecznym rolnikÃ³w. Odpowiedzi nie stanowiÄ… porady prawnej.\n                    </div>\n                </aside>\n\n                {/* Main chat */}\n                {activeConv.messages.length > 0 ? (\n                    <main className=\"flex-1 overflow-y-auto col-span-9 flex flex-col\">\n                        <header className=\"px-6 py-4 border-slate-200   flex items-center justify-between bg-white/40\">\n                            <div>\n                                <h3 className=\"text-lg font-semibold text-slate-800\">{activeConv.name}</h3>\n                            </div>\n                        </header>\n\n                        <section className=\"flex-1 p-6 overflow-y-auto  from-white to-slate-50 chat-messages bg-white/40\">\n                            <div className=\"max-w-3xl mx-auto space-y-4\">\n                                <AnimatePresence initial={false}>\n                                    {activeConv.messages.map((msg, idx) => (\n                                    <motion.div\n                                        key={msg.id}\n                                        initial={{ opacity: 0, y: 6 }}\n                                        animate={{ opacity: 1, y: 0 }}\n                                        exit={{ opacity: 0, y: -6 }}\n                                    >\n                                        <MessageBubble\n                                        msg={msg}\n                                        isLastAssistant={idx === lastAssistantIdx}\n                                        showFollowUp={canFollowUp && questionCount >= 1 && !followUpArmed}\n                                        onFollowUp={armFollowUp}\n                                        />\n                                    </motion.div>\n                                    ))}\n                                </AnimatePresence>\n\n                                {isTyping && (\n                                    <div className=\"flex items-start animate-pulse\">\n                                        <div className=\"w-9 h-9 rounded-full bg-green-100 flex items-center justify-center text-xs text-brand-dark font-bold\">\n                                            A\n                                        </div>\n                                        <div className=\"ml-3 px-4 py-2 bg-slate-100 rounded-xl text-sm shadow-sm italic text-gray-500\">Pisze...</div>\n                                    </div>\n                                )}\n                                <div ref={endRef} />\n                            </div>\n                        </section>\n\n                        <form\n                            onSubmit={handleSend}\n                            className=\"px-6 py-4  border-slate-200  shadow-inner shrink-0 bg-white/40\"\n                        >\n                            <div className=\"max-w-3xl mx-auto flex gap-3 \">\n                            <textarea\n                                ref={textareaRef}\n                                value={input}\n                                rows={1}\n                                onKeyDown={handleSendEnter}\n                                onChange={(e) => setInput(e.target.value)}\n                                className=\"input-text border-green resize-none  flex-1 p-3 rounded-xl border border-slate-200 focus:outline-none focus:ring-1 focus:ring-brand shadow-sm\"\n                                placeholder=\"Zadaj pytanie...\"\n                            />\n                                <button\n                                    type=\"submit\"\n                                    className=\"px-5 py-2 rounded-xl bg-brand hover:bg-brand-dark transition text-white font-medium shadow-md disabled:opacity-50\"\n                                    disabled={!input.trim()}\n                                >\n                                    <img height={20} width={20} src={sendIcon} alt=\"send\" />\n                                </button>\n                            </div>\n                        </form>\n                    </main>\n                ) : (\n                    <main className=\"flex-1 overflow-y-auto col-span-9 flex flex-col\">\n                        <motion.section\n                            key=\"welcome\"\n                            className=\"flex-1 flex flex-col items-center welcome-stext justify-center text-center px-6 bg-white/40\"\n                            initial={{ opacity: 0 }}\n                            animate={{ opacity: 1 }}\n                            exit={{ opacity: 0 }}\n                        >\n                            <h1 className=\"main-text text-2xl font-bold  mb-4\">\n                                ðŸ‘‹ Witaj! Tu Asystent Kasy Rolniczego Ubezpieczenia SpoÅ‚ecznego\n                            </h1>\n                            <p className=\"main-text text-semibold mb-8 max-w-screen-lg\">\n                                Udzielam informacji w zakresie ustawy o ubezpieczeniu spoÅ‚ecznym rolnikÃ³w, w tym kogo obejmuje ubezpieczenie i jakie Å›wiadczenia przysÅ‚ugujÄ…. MogÄ™ takÅ¼e odpowiadaÄ‡ na pytania dotyczÄ…ce danych statystycznych, takich jak kwoty i liczba Å›wiadczeÅ„ w latach 2024â€“2025.<br/>\n                                Udzielane informacje majÄ… charakter ogÃ³lny i nie stanowiÄ… porady prawnej ani indywidualnej interpretacji przepisÃ³w.                            </p>\n                            <div className=\"w-full max-w-2xl\">\n                                <form onSubmit={handleSend} className=\"flex gap-3\">\n                                    <textarea\n                                        ref={textareaRef}\n                                        value={input}\n                                        rows={1}\n                                        onKeyDown={handleSendEnter}\n                                        onChange={(e) => setInput(e.target.value)}\n                                        className=\"input-text resize-none flex-1 p-3 rounded-xl border border-slate-200 focus:outline-none focus:ring-1 focus:ring-brand shadow-sm\"\n                                        placeholder=\"Zadaj pytanie...\"\n                                    />\n                                    <button\n                                        type=\"submit\"\n                                        className=\"px-5 py-2 rounded-xl bg-brand hover:bg-brand-dark transition text-white font-medium shadow-md disabled:opacity-50\"\n                                        disabled={!input.trim()}\n                                    >\n                                        <img height={20} width={20} src={sendIcon} alt=\"send\" />\n                                    </button>\n                                </form>\n                            </div>\n                        </motion.section>\n                    </main>\n                )}\n\n            </div>\n        </div>\n    );\n}\n\nfunction MessageBubble({ msg, isLastAssistant = false, showFollowUp = false, onFollowUp }) {\n  if (msg.role === \"user\") {\n    return (\n      <div className=\"flex items-start justify-end\">\n        <div className=\"max-w-[70%]\">\n          <div className=\"text-xs text-slate-400 text-right mb-1\">Ty</div>\n          <div className=\"bg-brand text-white px-4 py-2 rounded-xl text-sm shadow-md break-words whitespace-pre-wrap\">\n            {msg.text}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  const safeText = (msg.text ?? \"\").replace(/\\\\n/g, \"\\n\");\n\n  return (\n    <div className=\"flex items-start\">\n      <div className=\"w-9 h-9 rounded-full bg-brand-light flex items-center justify-center text-xs ai-text font-bold\">A</div>\n      <div className=\"ml-3 max-w-[70%]\">\n        <div className=\"text-xs text-slate-400 mb-1\">Asystent</div>\n\n        {/* Tekst odpowiedzi */}\n        {safeText && safeText !== \"[[TABLE]]\" && (\n          <div className=\"bg-white px-4 py-2 rounded-xl border border-slate-200 text-sm shadow-sm break-words whitespace-pre-wrap\">\n            {safeText}\n          </div>\n        )}\n\n        {/* Tabela (jeÅ›li jest) */}\n        {msg.table && Array.isArray(msg.table.rows) && msg.table.rows.length > 0 && (\n          <div className=\"mt-2 bg-white rounded-xl border border-slate-200 shadow-sm overflow-x-auto\">\n            <table className=\"min-w-full text-sm\">\n              <thead className=\"bg-slate-50\">\n                <tr>\n                  {(msg.table.cols ?? Object.keys(msg.table.rows[0] ?? {})).map((c) => (\n                    <th key={c} className=\"px-3 py-2 text-left font-semibold text-slate-700 border-b\">\n                      {headerLabel(c)}\n                    </th>\n                  ))}\n                </tr>\n              </thead>\n              <tbody>\n                {msg.table.rows.map((r, idx) => (\n                  <tr key={idx} className=\"even:bg-slate-50/40\">\n                    {(msg.table.cols ?? Object.keys(r)).map((c) => (\n                      <td key={c} className=\"px-3 py-2 text-slate-800 border-b align-top\">\n                        {formatCell(r[c], c)}\n                      </td>\n                    ))}\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        )}\n\n        {/* Guzik follow-up: WYÅšRODKOWANY, zielony jak \"WyÅ›lij\", biaÅ‚a czcionka */}\n        {isLastAssistant && showFollowUp && (\n          <div className=\"mt-3\">\n            <button\n              onClick={onFollowUp}\n              className=\"mx-auto block px-5 py-2 rounded-xl bg-brand hover:bg-brand-dark transition text-white font-medium shadow-md focus:outline-none focus:ring-2 focus:ring-brand/40\"\n              title=\"NastÄ™pne pytanie potraktujÄ™ jako dopytanie.\"\n            >\n              ChciaÅ‚bym dopytaÄ‡\n            </button>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\n// Å‚adniejsze nagÅ‚Ã³wki\nfunction headerLabel(key) {\n  const map = {\n    value: \"wartoÅ›Ä‡\",\n    dataset: \"tabela\",\n    measure: \"miara\",\n    type: \"typ\",\n    okres: \"okres\",\n    region: \"region\",\n    ce: \"ce\",\n    rrf: \"rrf\",\n  };\n  return map[key] ?? key;\n}\n\n// delikatne formatowanie wartoÅ›ci\nfunction formatCell(v, key) {\n  if (v == null) return \"â€”\";\n  if ((key === \"value\" || key === \"ce\" || key === \"rrf\") && typeof v === \"number\") {\n    // value: do 2 miejsc; ce/rrf: do 3\n    const digits = key === \"value\" ? 2 : 3;\n    return v.toLocaleString(\"pl-PL\", { maximumFractionDigits: digits });\n  }\n  return String(v);\n}\n\n\nfunction formatAgo(ts) {\n    if (!ts) return \"â€”\";\n    const diff = Math.floor((Date.now() - ts) / 1000);\n    if (diff < 60) return `${diff}s`;\n    if (diff < 3600) return `${Math.floor(diff / 60)}m`;\n    if (diff < 86400) return `${Math.floor(diff / 3600)}h`;\n    return `${Math.floor(diff / 86400)}d`;\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}